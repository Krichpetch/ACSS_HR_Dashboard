<span style="font-family: verdana, geneva, sans-serif;">
  <!DOCTYPE html>
    <html lang="en">
    <head>
      <meta charset="UTF-8" />
      <title>Attendance Dashboard | Welcome </title>
       <?!= include("check-in-css"); ?>
      <!-- Font Awesome Cdn Link -->
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"/>
      <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

    </head>

    <script>
  google.script.run.withSuccessHandler(function(url) {
    console.log("URL:", url);
  }).getScriptUrl();
</script>


    <body>
      <div class="container">
       <nav class="navbar">
          <ul>
            <li>
                <a href="/index" class="logo">
                    <img src="https://cdn.akamai.steamstatic.com/steam/apps/1966720/capsule_616x353.jpg?t=1700231592">
                    <span class="nav-item">Lethal CO.</span>
        </a>
        </li>

        <li class="menu">
          <?var url = getScriptUrl();?>
            <a href="<?=url?>?v=attendance">
                <i class="fas fa-chart-bar"></i>
                <span class="nav-item">Attendance</span>
            </a>
        </li>
        <li class="menu">
            <a href="/Check-in">
                <i class="fas fa-user"></i>
                <span class="nav-item">Check-in</span>
            </a>
        </li>
        <li class="menu">
            <a href="/Edit">
                <i class="fas fa-cog"></i>
                <span class="nav-item">Edit</span>
            </a>
        </li>

        </ul>

        </nav>


<section class="main">
    <div class="main-top">
        <h1>Employee Index</h1>
    </div>

    <div id="main">
        

    </div>
            
                
    </div>
</section>

</div>

<script>

       google.script.run
        .withSuccessHandler(function(data) {
          console.log("Data received:", data);
        })
      .getData();

      document.addEventListener("DOMContentLoaded", function() {
        google.script.run.withSuccessHandler(generateCard).getData();
      });


      function generateCard(dataArray) {
        if (!dataArray || dataArray.length === 0) {
          console.log("No data found.");
          return;
        }

        var container = document.getElementById("main");

        for (var i = 0; i < dataArray.length; i += 4) {

          var users = document.createElement("div");
          users.classList.add("users");
          container.appendChild(users);

            for (var j = i; j < Math.min(i + 4, dataArray.length); j++) {

              var card = document.createElement("div");
              card.classList.add("card");

              //create image
              var image = document.createElement("img");
              image.src = dataArray[j][5]; 

              //create text elements 
              var name = document.createElement("h4");
              name.textContent = dataArray[j][1];

              var employeeID = document.createElement("p");
              employeeID.classList.add("employeeID");
              employeeID.textContent = "ID: " + dataArray[j][0];

              var position = document.createElement("p");
              position.textContent = "Position: " + dataArray[j][2];

              var divideLine = document.createElement("p");
              divideLine.classList.add("divideline");
              divideLine.textContent = "--------------------------";


              //element for table
              var per = document.createElement("div");
              per.classList.add("per");

              //create table element
              var table = document.createElement("table");

              //create tr
              var tr = document.createElement("tr");

              //create i
              var email = document.createElement("i");
              email.classList.add("bx", "bxl-gmail", "tooltip");
              email.textContent = "\u00A0\u00A0\u00A0";

              var emailText = document.createElement("span");
              emailText.classList.add("tooltiptext");
              emailText.textContent = dataArray[j][3];
            
               //create i
              var phone = document.createElement("i");
              phone.classList.add("bx", "bxs-phone", "tooltip");
              phone.textContent = "\u00A0\u00A0\u00A0";

              var phoneText = document.createElement("span");
              phoneText.classList.add("tooltiptext");
              phoneText.textContent = dataArray[j][4];
            
              //create i
              var editLink = document.createElement("a");
              editLink.href = "#";
              
              var edit = document.createElement("i");
              edit.classList.add("bx", "bxs-edit", "tooltip",);

              var editText = document.createElement("span");
              editText.classList.add("tooltiptext");
              editText.textContent = "Edit";

              //create footer
              var company = document.createElement("button");
              company.classList.add("cancel-btn");
              company.textContent = "LETHAL COMPANY.CO";

              //appending elements

              editLink.appendChild(edit);

              phone.appendChild(phoneText);

              email.appendChild(emailText);

              tr.appendChild(email);
              tr.appendChild(phone);
              tr.appendChild(editLink);

              table.appendChild(tr);

              per.appendChild(table);

              card.appendChild(image);
              card.appendChild(name);
              card.appendChild(position);
              card.appendChild(employeeID);
              card.appendChild(divideLine);
              card.appendChild(per);
              card.appendChild(company);

              users.appendChild(card);
              
              main.appendChild(users);
            }
          }
        }

    </script>


</body>

</html>
</span>